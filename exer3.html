<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Gamedev Canvas Workshop</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas" width="480" height="320"></canvas>

<script>
var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");
var rectWidth = 10;
var rectHeight = 15;
var x = canvas.width/2 - 50;
var y = canvas.height-30;
var dx = 0;
var dy = -1;
var rightPressed = false;
var leftPressed = false;
var paddleHeight = 10;
var paddleWidth = 75;
var brickSpeed = 0.5;
var paddleCount = 3;
var paddleX =  getRandomArbitrary(0,canvas.width - paddleWidth);
var paddleY = (canvas.height-paddleHeight) / 2;	

var brickColumnCount = 3;
var brickRowCount =  3;

var up = true;
var down = false;
var start = false;

var jumpHeight = -1000;
var paddleSpeed = 1;

var paddlesStatic = [];
var paddlesDynamic = [];

function copy(aObject) {
  if (!aObject) {
    return aObject;
  }

  let v;
  let bObject = Array.isArray(aObject) ? [] : {};
  for (const k in aObject) {
    v = aObject[k];
    bObject[k] = (typeof v === "object") ? copy(v) : v;
  }

  return bObject;
}

for(var c=0; c<brickColumnCount; c++) {
    paddlesStatic[c] = [];
    for(var r=0; r<brickRowCount; r++) {
        paddlesStatic[c][r] = { x: r * paddleWidth, y: c * 150 - 150 ,status: 0, moveStatus: false};
    }
}

 paddlesDynamic  = copy(paddlesStatic);


function drawRect() {
    ctx.beginPath();
    ctx.rect(x, y, rectWidth, rectHeight);
    ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
}

function getRandomArbitrary(min, max) {
  return Math.random() * (max - min) + min;
}

function drawPaddleName(pointX,pointY,number) {
    ctx.font = "16px Arial";
    ctx.fillStyle = "#009555";
    ctx.fillText("Number"+number,pointX , pointY);
}
function drawStatus(pointX,pointY,text) {
    ctx.font = "16px Arial";
    ctx.fillStyle = "#FFFFFF";
    ctx.fillText(text,pointX , pointY);
}

function drawPaddle(x,y,width,height) {
    ctx.beginPath();
    ctx.rect(x, y, width, height);
    ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
}

function movePaddleOld(){
    for (var c = 0;c < paddleCount; c++){
        
	for (var v = 0; v < paddleCount; v++){
	var p = paddlesDynamic[c][v];
        if(p.status == 0){
            p.status = 1;
            p.moveStatus = false; 
            //p.x = paddlesStatic.x;
            //p.y = paddlesStatic.y
	
            drawPaddle(paddleX,paddleY,paddleWidth,paddleHeight);
            drawPaddleName(paddleX,paddleY,c);
            drawStatus(paddleX + paddleWidth / 2,paddleY+paddleHeight,p.moveStatus );
        }
        else{ 
            paddleX =  p.x;
            if(p.moveStatus == true){
	            p.y += 1;    
            } 
            paddleY =  p.y ;
            if (paddleY + paddleHeight > canvas.height  ) {
	            //p.status = 0;
	          // p.y = paddlesStatic[][];
	            //p.y = -150;
	        } 
            drawPaddle(paddleX,paddleY,paddleWidth,paddleHeight);
            drawPaddleName(paddleX,paddleY,c);
            drawStatus(paddleX + paddleWidth / 2,paddleY+paddleHeight,p.moveStatus );
        }
    }
    }

}

function movePaddle(){
    for (var c = 0;c < paddleCount; c++){
        
	for (var v = 0; v < paddleCount; v++){
		var p = paddlesDynamic[c][v];
		if(p.status == 0){
		p.status = 1;
		p.moveStatus = false; 
		paddleX = p.x;
		paddleY = p.y;
		drawPaddle(paddleX,paddleY,paddleWidth,paddleHeight);
		drawPaddleName(paddleX,paddleY,c);
		drawStatus(paddleX + paddleWidth / 2,paddleY+paddleHeight,p.moveStatus );
        }
        else{ 
	p.y  += -dy;
        paddleY = p.y;
	paddleX = p.x;
	if (paddleY + paddleHeight > canvas.height  ) {
	        //p.status = 0;
		var y = paddlesDynamic[c][v].y;
		var yNew = paddlesStatic[(c - (paddleCount - 1)) * -1][v].y;
		paddlesDynamic[c][v].y = paddlesStatic[(c - (paddleCount - 1)) * -1][v].y - 150;
	            //p.y = -150;
	        } 
	drawPaddle(paddleX,paddleY,paddleWidth,paddleHeight);
        drawPaddleName(paddleX,paddleY,c);
        drawStatus(paddleX + paddleWidth / 2,paddleY+paddleHeight,p.moveStatus );
        }
    }
    }

}

function moveDetection(){
for(var c=0; c<paddleCount; c++) {
	for (var v = 0; v < paddleCount; v++){
	  var b = paddlesDynamic[c][v];
	   if(y + dy + rectHeight  > b.y  && y + dy + rectHeight  < b.y + paddleHeight  && x > b.x && x < b.x + paddleWidth && dy > 0 ) {
	     y  = b.y - rectHeight;
		dy = 1;
		dy = -dy * 1.9;
		}    
}		
	/* if (y + dy <= b.y - 200 )//if (y +  rectHeight <=  b.y - rectHeight * 5   )
		{
			dy = -dy / 1.5;
		} */
}
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawRect();
    movePaddle();

    if (y + dy < -1500/*|| y + dy < -20  */) { //top point
        dy = -dy ;  // the fall
       // paddleSpeed = 1;
       // dy = 0;
        /* for (var num1  in paddlesDynamic){
		for (var num2  in paddlesDynamic){
            paddlesDynamic[num1][num2].moveStatus =true;
		} */
	
    }   
    if (y + dy > canvas.height - rectHeight /* && down != false */) {  //bottom point
	dy = -1;
    }  
     
    
    y += dy ;
    //moveDetection();
    if(rightPressed) {
    x += 5;
    if (x + paddleWidth > canvas.width){
        x = canvas.width - paddleWidth;
    }
}
else if(leftPressed) {
    x -= 5;
    if (x < 0){
        x = 0;
    }
}
}

document.addEventListener("keydown", keyDownHandler, false);
document.addEventListener("keyup", keyUpHandler, false);

function keyDownHandler(e) {
    if(e.key == "Right" || e.key == "ArrowRight") {
        rightPressed = true;
    }
    else if(e.key == "Left" || e.key == "ArrowLeft") {
        leftPressed = true;
    }
}

function keyUpHandler(e) {
    if(e.key == "Right" || e.key == "ArrowRight") {
        rightPressed = false;
    }
    else if(e.key == "Left" || e.key == "ArrowLeft") {
        leftPressed = false;
    }
}

setInterval(draw, 10);

</script>

</body>
</html>